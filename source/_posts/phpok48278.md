---
title: PHPOK4.8.278 XSS
date: 2018-08-29 22:34:32
categories: 代码审计
tags: phpok
---

### Official website:
https://www.phpok.com/


### Download link:
https://www.phpok.com/23987.html


### Version:
PHPOK4.8.278


### Vulnerability type:
XSS


### Description:
PHPOK4.8.278 has an Reflected XSS vulnerability in framework/www/login_control.php.

### File:
framework/www/login_control.php


### Detail

![](code.png)

In ok_f() function , the program doesn't filter the parameter $_back .
Attacker can make an XSS vulnerability.


POC
```
https://example.com/index.php?c=login&_back=javascript:alert(document.cookie);
```

After a logined user clicks the link or waits for 2 second , the demo will alert cookie.

![](1.png)


If the user doesn't login , the website will redirect to login page , then it will alert cookie after login.

![](2.png)
![](3.png)